<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Make A Wish</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
    /* --- ATMOSPHERE & LIGHTING --- */
    body {
        min-height: 100vh; margin: 0; font-family: 'Poppins', sans-serif;
        background-color: #1a0b12; /* Dark base */
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        overflow: hidden;
        transition: background-color 3s ease;
    }

    /* The Warm Glow Vignette (Simulates Candle Light) */
    .lighting-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle at 50% 70%, rgba(255, 160, 50, 0.2) 0%, rgba(26, 11, 18, 0.9) 60%, #1a0b12 100%);
        pointer-events: none; z-index: 1;
        transition: opacity 2s ease;
        animation: lightPulse 3s infinite alternate; /* Light breathes */
    }
    
    @keyframes lightPulse {
        0% { opacity: 0.8; transform: scale(1); }
        100% { opacity: 1; transform: scale(1.02); }
    }

    /* Texture */
    .texture {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.7" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.05"/></svg>');
        pointer-events: none; z-index: 2; opacity: 0.4;
    }

    /* Border */
    #frame-border {
        position: fixed; top: 20px; left: 20px; right: 20px; bottom: 20px;
        border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 20px; 
        pointer-events: none; z-index: 99; transition: border-color 2s, opacity 2s;
    }


    /* --- THE REALISTIC CANDLE --- */
    .candle-container {
        position: relative;
        width: 120px; height: 350px;
        display: flex; flex-direction: column; align-items: center; justify-content: flex-end;
        cursor: pointer; z-index: 10;
        margin-top: 60px;
    }

    /* Wax Body */
    .candle {
        width: 70px; height: 180px;
        background: linear-gradient(to right, #e8c39e, #ffefd5 40%, #ffefd5 60%, #deb887);
        border-radius: 8px;
        box-shadow: inset 0 -20px 30px rgba(0,0,0,0.3), 0 0 20px rgba(255, 160, 50, 0.1);
        position: relative;
    }
    .candle::before { /* Melted wax pool on top */
        content: ""; position: absolute; top: -12px; left: 0; width: 100%; height: 25px;
        background: radial-gradient(#fff9f0, #ffe4c4);
        border-radius: 50%;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    /* Wick */
    .wick {
        width: 4px; height: 18px; background: linear-gradient(#333, #555);
        margin-bottom: -8px; z-index: 12; border-radius: 2px;
    }
    .wick::after { /* Red glowing tip */
        content:""; position: absolute; top: 0; left: 0; width: 100%; height: 6px;
        background: #ff4500; border-radius: 50%; opacity: 0.8;
    }

    /* Realistic Flame Structure */
    .flame-container {
        position: relative; width: 30px; height: 60px;
        transform-origin: bottom center;
        animation: flameFlicker 3s infinite;
        transition: opacity 0.3s, transform 0.3s;
    }
    
    .flame-main {
        position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
        width: 30px; height: 60px;
        background: radial-gradient(ellipse at bottom, rgba(255,255,255,0.9) 0%, rgba(255,255,0,0.6) 30%, rgba(255,140,0,0.4) 70%, transparent 100%);
        border-radius: 50% 50% 20% 20%;
        filter: blur(2px);
    }
    
    .flame-glow {
        position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
        width: 80px; height: 80px;
        background: radial-gradient(circle, rgba(255,160,50,0.4) 0%, transparent 70%);
        border-radius: 50%;
        animation: glowPulse 0.1s infinite alternate;
    }

    /* Natural Flicker Animation */
    @keyframes flameFlicker {
        0%, 100% { transform: scale(1) rotate(-1deg); }
        25% { transform: scale(1.05) rotate(1deg); }
        50% { transform: scale(0.95) rotate(-2deg); }
        75% { transform: scale(1.02) rotate(2deg); }
    }
    @keyframes glowPulse {
        from { opacity: 0.8; transform: translateX(-50%) scale(1); }
        to { opacity: 1; transform: translateX(-50%) scale(1.1); }
    }


    /* --- REALISTIC SMOKE PARTICLES (Generated by JS) --- */
    .smoke-particle {
        position: absolute;
        bottom: 200px; /* Start near wick */
        left: 50%;
        background: radial-gradient(circle, rgba(200,200,200,0.4) 0%, rgba(150,150,150,0) 70%);
        border-radius: 50%;
        pointer-events: none;
        filter: blur(8px);
        opacity: 0;
        z-index: 20;
    }
    
    /* This animation is applied dynamically in JS for random movement */
    @keyframes riseRealistic {
        0% { opacity: 0; transform: translate(-50%, 0) scale(0.5); }
        10% { opacity: 0.6; transform: translate(var(--moveX), -30px) scale(1.5); }
        100% { opacity: 0; transform: translate(var(--finalX), -250px) scale(4); }
    }


    /* --- TEXT CONTENT --- */
    .text-container {
        position: absolute; top: 18%; width: 100%; text-align: center; z-index: 50;
    }

    .instruction {
        font-family: 'Dancing Script', cursive; font-size: 30px; color: #ffebcd;
        text-shadow: 0 0 10px rgba(255, 160, 50, 0.5);
        transition: opacity 1s;
    }
    .instruction small {
        display: block; font-family: 'Poppins', sans-serif; font-size: 14px; 
        color: rgba(255,255,255,0.5); margin-top: 10px; letter-spacing: 1px;
    }

    .final-wish-container {
        position: absolute; width: 100%; top: 0;
        display: flex; flex-direction: column; align-items: center;
        opacity: 0; pointer-events: none;
        transition: opacity 2s 1s;
    }
    
    .final-wish {
        font-family: 'Cinzel', serif; font-size: 34px; 
        background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        margin-bottom: 20px;
        filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
    }

    .sub-text {
        font-family: 'Dancing Script', cursive; font-size: 26px; color: #e0e0e0;
        line-height: 1.6;
        text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    }


    /* --- UTILITIES --- */
    .dark-mode-active { background-color: #050203 !important; } /* Total black */
    .lights-out { opacity: 0 !important; }
    
    .restart-btn {
        position: fixed; bottom: 40px;
        padding: 12px 35px; border: 1px solid rgba(255,255,255,0.2); 
        color: rgba(255,255,255,0.5);
        background: transparent; border-radius: 30px; cursor: pointer;
        opacity: 0; transition: 0.5s; font-family: 'Poppins', sans-serif; letter-spacing: 1px;
        z-index: 100;
    }
    .restart-btn:hover { border-color: #d4af37; color: #d4af37; background: rgba(255,255,255,0.05); }

</style>
</head>
<body>

    <audio autoplay loop>
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <div class="texture"></div>
    <div class="lighting-overlay" id="lighting"></div>
    <div id="frame-border"></div>

    <div class="text-container">
        <div class="instruction" id="instruction">
            Make a wish...
            <small>Tap the flame to blow it out</small>
        </div>

        <div class="final-wish-container" id="final-wish">
            <div class="final-wish">✨ Wish Granted ✨</div>
            <div class="sub-text">
                Happy Birthday, Riya.<br>
                May your life be full of magic.<br>
                Always. ❤️
            </div>
        </div>
    </div>

    <div class="candle-container" onclick="blowCandle()">
        <div class="flame-container" id="flame">
            <div class="flame-glow"></div>
            <div class="flame-main"></div>
        </div>
        <div class="wick"></div>
        <div class="candle"></div>
    </div>

    <button class="restart-btn" id="restart-btn" onclick="window.location.href='index.html'">Watch Again</button>

    <script>
        let blown = false;

        function blowCandle() {
            if(blown) return;
            blown = true;

            const flame = document.getElementById('flame');
            const lighting = document.getElementById('lighting');
            const body = document.body;
            const instr = document.getElementById('instruction');
            const finalDiv = document.getElementById('final-wish');
            const btn = document.getElementById('restart-btn');
            const border = document.getElementById('frame-border');

            // 1. Extinguish Flame
            flame.style.opacity = '0';
            flame.style.transform = 'scale(0.5)';

            // 2. Turn off the Lights (Vignette disappears)
            lighting.classList.add('lights-out');
            body.classList.add('dark-mode-active');
            border.style.opacity = '0.2';
            border.style.borderColor = '#333';

            // 3. Generate REALISTIC SMOKE
            createRealisticSmoke();

            // 4. Handle Text
            instr.style.opacity = '0';
            setTimeout(() => {
                finalDiv.style.opacity = '1';
                finalDiv.style.pointerEvents = 'all';
                btn.style.opacity = '1';
            }, 1500);
        }

        function createRealisticSmoke() {
            const container = document.querySelector('.candle-container');
            const particleCount = 30; // More particles for realism

            for (let i = 0; i < particleCount; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.classList.add('smoke-particle');
                    
                    // Randomize movement variables
                    const moveX = (Math.random() - 0.5) * 50 + 'px'; // Wiggle left/right
                    const finalX = (Math.random() - 0.5) * 150 + 'px'; // Drift far away
                    const size = (Math.random() * 20 + 10) + 'px'; // Random size
                    const duration = (Math.random() * 2 + 2) + 's'; // Random speed

                    particle.style.width = size;
                    particle.style.height = size;
                    particle.style.setProperty('--moveX', moveX);
                    particle.style.setProperty('--finalX', finalX);
                    
                    // Apply animation
                    particle.style.animation = `riseRealistic ${duration} forwards ease-out`;

                    container.appendChild(particle);

                    // Clean up
                    setTimeout(() => particle.remove(), 4000);

                }, i * 50); // Stagger the particles slightly so they don't all appear at once
            }
        }
    </script>

</body>
</html>
