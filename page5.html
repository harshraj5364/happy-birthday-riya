<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Make A Wish</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">

<style>
    /* --- ATMOSPHERE --- */
    body {
        min-height: 100vh; margin: 0; font-family: 'Poppins', sans-serif;
        background-color: #1a0b12; /* Dark warm base */
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        overflow: hidden;
        transition: background-color 3s ease;
    }

    /* Warm Candle Light Overlay */
    .light-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(circle at 50% 60%, rgba(255, 180, 60, 0.15) 0%, rgba(0,0,0,0.8) 60%, #000 100%);
        pointer-events: none; /* IMPORTANT: Lets clicks pass through */
        z-index: 10;
        transition: opacity 1.5s ease;
        animation: ambientFlicker 4s infinite alternate;
    }
    @keyframes ambientFlicker {
        0% { opacity: 1; transform: scale(1); }
        100% { opacity: 0.9; transform: scale(1.01); }
    }

    /* Starry Background */
    .starry-night {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
        z-index: 1; opacity: 0; transition: opacity 3s ease 1s;
        pointer-events: none;
    }
    .star {
        position: absolute; background: white; border-radius: 50%;
        animation: twinkle 2s infinite ease-in-out;
    }
    @keyframes twinkle { 0%, 100%{opacity:0.3;} 50%{opacity:1;} }

    #frame-border {
        position: fixed; top: 20px; left: 20px; right: 20px; bottom: 20px;
        border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 20px; 
        pointer-events: none; z-index: 99; transition: opacity 2s;
    }


    /* --- CANDLE STAGE --- */
    .candle-stage {
        position: relative; width: 100%; height: 400px;
        display: flex; justify-content: center; align-items: flex-end;
        z-index: 20; transition: opacity 1s;
        pointer-events: none; /* Let clicks pass through area to the flame */
    }

    .candle-body {
        width: 80px; height: 200px;
        background: linear-gradient(to right, #e8c39e 0%, #ffefd5 45%, #fff5e6 55%, #deb887 100%);
        border-radius: 6px;
        box-shadow: inset 0 20px 30px rgba(255, 140, 0, 0.2), inset 0 -20px 30px rgba(0,0,0,0.1), 0 0 20px rgba(255, 100, 0, 0.1);
        position: relative;
        pointer-events: auto;
    }
    .candle-body::before { /* Melted Pool */
        content: ""; position: absolute; top: -15px; left: 0; width: 100%; height: 30px;
        background: radial-gradient(circle, #fffdf5 20%, #ffdfb0 100%);
        border-radius: 50%;
        box-shadow: 0 2px 10px rgba(255, 140, 0, 0.4);
    }

    .wick {
        position: absolute; top: -25px; left: 50%; transform: translateX(-50%);
        width: 4px; height: 15px; background: #222; border-radius: 2px; z-index: 22;
    }
    .wick::after { content:""; position: absolute; top:0; left:0; width:100%; height:5px; background: #ff5500; border-radius: 50%; opacity: 0.8; }

    /* FLAME - CLICKABLE AREA */
    .flame-container {
        position: absolute; top: -90px; left: 50%; transform: translateX(-50%);
        width: 60px; height: 100px; /* Made bigger for easier clicking */
        transform-origin: bottom center;
        animation: physicsFlicker 3s infinite; transition: all 0.5s; 
        z-index: 100; /* Highest Z-Index to ensure clickability */
        cursor: pointer;
        pointer-events: auto; /* Force clickable */
    }
    
    .flame-core {
        position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
        width: 30px; height: 60px;
        background: radial-gradient(ellipse at bottom, rgba(255,255,255,0.9) 0%, rgba(255,255,0,0.6) 30%, rgba(255,100,0,0.3) 70%, transparent 100%);
        border-radius: 50% 50% 20% 20%; filter: blur(2px);
    }
    .flame-halo {
        position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
        width: 120px; height: 120px; background: radial-gradient(circle, rgba(255,160,50,0.2) 0%, transparent 60%);
        border-radius: 50%; animation: glowPulse 0.2s infinite alternate; pointer-events: none;
    }
    @keyframes physicsFlicker {
        0% { transform: translateX(-50%) rotate(-1deg) scale(1); }
        50% { transform: translateX(-50%) rotate(1deg) scale(0.95); }
        100% { transform: translateX(-50%) rotate(-1deg) scale(1); }
    }
    
    .smoke {
        position: absolute; bottom: 220px; left: 50%; width: 10px; height: 10px;
        background: radial-gradient(circle, rgba(200,200,200,0.5) 0%, transparent 70%);
        border-radius: 50%; pointer-events: none; filter: blur(5px);
    }


    /* --- TEXT CONTENT --- */
    .text-area {
        position: absolute; top: 10%; width: 90%; text-align: center; z-index: 50;
        pointer-events: none; /* CRITICAL: Allows clicks to pass through text to the candle */
    }

    .instr-text {
        font-family: 'Dancing Script', cursive; font-size: 32px; color: #ffebcd;
        text-shadow: 0 0 20px rgba(255, 140, 0, 0.8);
        transition: opacity 1s; animation: floatText 3s infinite ease-in-out;
    }
    @keyframes floatText { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }

    .final-message {
        width: 100%; display: flex; flex-direction: column; align-items: center;
        opacity: 0; pointer-events: none; transition: opacity 2s 1.5s;
    }
    
    .wish-title {
        font-family: 'Cinzel', serif; font-size: 36px; 
        background: linear-gradient(to bottom, #fff, #ffd700);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5)); margin-bottom: 20px;
    }
    
    .wish-body {
        font-family: 'Poppins', sans-serif; font-size: 16px; color: #ccc;
        line-height: 1.6; text-shadow: 0 2px 5px black; margin-bottom: 20px;
    }

    .emotional-quote {
        font-family: 'Great Vibes', cursive; font-size: 30px; color: #ffaa9f;
        margin-bottom: 25px; transform: translateY(20px); opacity: 0;
        animation: slideUpFade 1.5s ease forwards 2.5s;
        text-shadow: 0 0 10px rgba(255, 111, 97, 0.3);
    }

    .promise-text {
        font-family: 'Dancing Script', cursive; font-size: 20px; color: #fff;
        opacity: 0; animation: slideUpFade 1.5s ease forwards 3.5s;
    }
    
    .thank-you {
        font-family: 'Cinzel', serif; font-size: 12px; color: #d4af37;
        letter-spacing: 3px; border-top: 1px solid rgba(212, 175, 55, 0.3);
        padding-top: 15px; margin-top: 25px;
        opacity: 0; animation: slideUpFade 1.5s ease forwards 5s;
    }

    @keyframes slideUpFade { to { transform: translateY(0); opacity: 1; } }


    /* --- UTILITIES --- */
    .lights-out { opacity: 0 !important; }
    .show-stars { opacity: 1 !important; }
    
    .restart-btn {
        position: fixed; bottom: 30px; padding: 10px 30px;
        background: transparent; border: 1px solid rgba(255,255,255,0.3); color: #666;
        border-radius: 30px; font-family: 'Poppins', sans-serif; font-size: 12px;
        opacity: 0; transition: 0.5s; cursor: pointer; z-index: 100; pointer-events: auto;
    }
    .restart-btn:hover { border-color: gold; color: gold; }

</style>
</head>
<body>

    <audio autoplay loop>
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <div class="starry-night" id="stars-bg"></div>
    <div class="light-overlay" id="room-light"></div>
    <div id="frame-border"></div>

    <div class="text-area">
        <div class="instr-text" id="instruction">
            Make a wish...<br>
            <span style="font-size:16px; font-family:'Poppins'; opacity:0.7;">(Tap the flame)</span>
        </div>

        <div class="final-message" id="final-msg">
            <div class="wish-title">‚ú® Wish Granted ‚ú®</div>
            
            <div class="wish-body">
                Happy Birthday, Princess. üéÇ<br>
                May this year bring you as much happiness<br>
                as you bring to everyone around you.
            </div>

            <div class="emotional-quote">
                "Tum sirf ek dost nahi,<br>
                Sukoon ho mera."
            </div>

            <div class="promise-text">
                Bas hamesha aise hi muskurate rehna,<br>
                kyunki tumhari smile meri favorite hai.<br>
                I'm always with you. ‚ù§Ô∏è
            </div>

            <div class="thank-you">
                THANK YOU FOR EXISTING
            </div>
        </div>
    </div>

    <div class="candle-stage">
        <div class="candle-body">
            <div class="wick"></div>
            <div class="flame-container" id="flame" onclick="blowCandle()">
                <div class="flame-halo"></div>
                <div class="flame-core"></div>
            </div>
        </div>
    </div>

    <button class="restart-btn" id="restart-btn" onclick="window.location.href='index.html'">Watch Again ‚Üª</button>

    <script>
        // Generate stars immediately
        const starsBg = document.getElementById('stars-bg');
        for(let i=0; i<100; i++) {
            let star = document.createElement('div');
            star.className = 'star';
            star.style.width = Math.random() * 3 + 'px';
            star.style.height = star.style.width;
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 2 + 's';
            starsBg.appendChild(star);
        }

        let blown = false;

        function blowCandle() {
            if(blown) return;
            blown = true;
            
            // Get Elements
            const flame = document.getElementById('flame');
            const roomLight = document.getElementById('room-light');
            const instr = document.getElementById('instruction');
            const finalMsg = document.getElementById('final-msg');
            const btn = document.getElementById('restart-btn');
            const stars = document.getElementById('stars-bg');
            const candleStage = document.querySelector('.candle-stage');

            // 1. Vanish Flame
            flame.style.opacity = '0';
            flame.style.transform = 'scale(0.5)';
            
            // 2. Darken Room
            roomLight.classList.add('lights-out');
            
            // 3. Smoke Effect
            makeSmoke();

            // 4. Fade out candle slightly
            setTimeout(() => { candleStage.style.opacity = '0.2'; }, 2000);

            // 5. Hide Instruction & Show Message
            instr.style.opacity = '0';
            
            setTimeout(() => {
                stars.classList.add('show-stars');
                finalMsg.style.opacity = '1';
                btn.style.opacity = '1';
                btn.style.pointerEvents = 'all'; // Enable button click
            }, 1000);
        }

        function makeSmoke() {
            const container = document.querySelector('.candle-stage');
            for(let i=0; i<40; i++) {
                setTimeout(() => {
                    let s = document.createElement('div');
                    s.className = 'smoke';
                    let left = (Math.random() - 0.5) * 60 + 'px';
                    let dur = (Math.random() * 2 + 3) + 's';
                    s.style.left = `calc(50% + ${left})`;
                    s.style.bottom = '200px'; 
                    
                    // Standard CSS animation for better compatibility
                    s.style.animation = `rise ${dur} forwards`; 
                    
                    // Adding manual style just in case
                    s.style.transition = `transform ${dur} linear, opacity ${dur} ease-in`;
                    setTimeout(() => {
                        s.style.transform = `translate(${left}, -250px) scale(4)`;
                        s.style.opacity = '0';
                    }, 50);

                    container.appendChild(s);
                    setTimeout(() => s.remove(), 4000);
                }, i * 50);
            }
        }
    </script>
    
    <style>
        @keyframes rise {
            0% { transform: translate(0,0) scale(1); opacity: 0.6; }
            100% { transform: translate(var(--moveX, 20px), -250px) scale(4); opacity: 0; }
        }
    </style>

</body>
</html>
